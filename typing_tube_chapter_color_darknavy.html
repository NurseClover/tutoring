
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>íŠœë¸Œ íƒ€ì ì—°ìŠµ - ì±•í„° ì„ íƒ</title>
  <style>
    body {
      font-family: 'Malgun Gothic', sans-serif;
      background-color: #fceeee;
      margin: 0;
      padding: 20px;
      text-align: center;
      color: black;
    }
    h1 { margin-bottom: 10px; }
    #gameArea {
      position: relative;
      width: 100%;
      height: 400px;
      border: 2px solid #ccc;
      margin: 20px auto;
      overflow: hidden;
      background: #fff;
    }
    .word {
      text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
      border: 1px solid rgba(0,0,0,0.1);
      padding: 4px 8px;
      background-color: rgba(255,255,255,0.95);

      position: absolute;
      font-size: 28px;
      font-weight: bold;
      color: black;
      animation: drop linear forwards;
    }
    @keyframes drop {
      0% { top: 0px; }
      100% { top: 400px; }
    }
    input {
      font-size: 20px;
      padding: 10px;
      width: 300px;
    }
    #status { margin-top: 10px; }
    select {
      font-size: 16px;
      padding: 5px 10px;
    }
  </style>
</head>
<body>
  <h1>ğŸ§ª íŠœë¸Œ íƒ€ì ì—°ìŠµ - ì±•í„° ì„ íƒ</h1>
  <p>
    ì±•í„° ì„ íƒ:
    <select id="chapterSelect">
      <option value="random">ğŸ² ëœë¤</option>
      <option value="basic">ê¸°ì´ˆ ë‹¨ì–´</option>
      <option value="medical">ì˜í•™ ìš©ì–´</option>
      <option value="daily">ìƒí™œ ì˜ì–´</option>
    </select>
  </p>
  <p>ì •ë‹µ ì…ë ¥: ì˜ì–´ê°€ ë–¨ì–´ì§€ë©´ í•œê¸€ ì…ë ¥, í•œê¸€ì´ ë–¨ì–´ì§€ë©´ ì˜ì–´ ì…ë ¥</p>
  <p>ğŸ•’ <span id="timer">60</span>ì´ˆ | â¤ï¸ <span id="life">5</span> | ì ìˆ˜: <span id="score">0</span></p>
  <div id="gameArea"></div>
  <input type="text" id="answerInput" placeholder="ì •ë‹µ ì…ë ¥ í›„ Enter" autofocus />
  <div id="status"></div>

  <script>
    const wordData = {
      basic: [["apple", "ì‚¬ê³¼"], ["book", "ì±…"]],
      medical: [["nurse", "ê°„í˜¸ì‚¬"], ["hospital", "ë³‘ì›"]],
      daily: [["water", "ë¬¼"], ["school", "í•™êµ"]]
    };

    let selectedWords = [];
    let score = 0;
    let life = 5;
    let timer = 60;
    let speed = 8;
    let activeWords = [];
    let streak = 0;
    let debuff = false;

    const chapterSelect = document.getElementById("chapterSelect");
chapterSelect.addEventListener("change", () => {
  location.reload();
});

    function getWords() {
      const chapter = chapterSelect.value;
      if (chapter === "random") {
        return Object.values(wordData).flat();
      } else {
        return wordData[chapter] || [];
      }
    }

    function updateStatus(text) {
      document.getElementById("status").innerText = text;
    }

    function spawnWord() {
      const area = document.getElementById("gameArea");
      const pair = selectedWords[Math.floor(Math.random() * selectedWords.length)];
      const showKorean = Math.random() < 0.5;
      const text = showKorean ? pair[1] : pair[0];
      const answer = showKorean ? pair[0] : pair[1];
      const colors = ["red", "blue", "yellow", "darkslateblue", "black"];
      const color = colors[Math.floor(Math.random() * colors.length)];

      const div = document.createElement("div");
      div.className = "word";
      div.innerText = text;
      div.dataset.answer = answer;
      div.dataset.color = color;
      div.style.color = color;
      div.style.left = Math.floor(Math.random() * 80) + "%";
      div.style.animationDuration = speed + "s";
      area.appendChild(div);
      activeWords.push(div);

      setTimeout(() => {
        if (activeWords.includes(div)) {
          area.removeChild(div);
          activeWords.splice(activeWords.indexOf(div), 1);
          streak++;
          if (streak >= 10) {
            timer = Math.max(0, timer - 20);
            updateStatus("âš ï¸ ì—°ì† 10ê°œ ë¯¸ì…ë ¥! ì‹œê°„ -20ì´ˆ");
            streak = 0;
          }
        }
      }, speed * 1000);
    }

    function startGame() {
      const chapter = chapterSelect.value;
      selectedWords = chapter === "random"
        ? Object.values(wordData).flat()
        : wordData[chapter];
      document.getElementById("score").innerText = score = 0;
      document.getElementById("life").innerText = life = 5;
      document.getElementById("timer").innerText = timer = 60;
      document.getElementById("answerInput").disabled = false;
      setInterval(() => {
        if (!debuff) timer--;
        document.getElementById("timer").innerText = timer;
        if (timer <= 0 || life <= 0) {
          timer = 0;
          document.getElementById("timer").innerText = timer;
          updateStatus("ê²Œì„ ì¢…ë£Œ! ì ìˆ˜: " + score);
          document.getElementById("answerInput").disabled = true;
        }
      }, 1000);
      setInterval(spawnWord, 2000);
      setInterval(() => {
        if (speed > 3) speed -= 0.5;
      }, 60000);
    }

    document.getElementById("answerInput").addEventListener("keydown", function(e) {
      if (e.key === "Enter") {
        const val = this.value.trim();
        let matched = false;
        for (let i = 0; i < activeWords.length; i++) {
          const word = activeWords[i];
          if (val === word.dataset.answer) {
            matched = true;
            const color = word.dataset.color;
            score += 10;
            if (color === "red") life++;
            else if (color === "blue") timer += 10;
            else if (color === "darkslateblue") life = Math.max(0, life - 3);
            else if (color === "yellow") {
              debuff = true;
              updateStatus("âš ï¸ ìƒíƒœì´ìƒ! 30ì´ˆê°„ ì‹œê°„/ìƒëª… ë©ˆì¶¤");
              setTimeout(() => {
                debuff = false;
                updateStatus("ìƒíƒœì´ìƒ í•´ì œ!");
              }, 30000);
            }
            document.getElementById("score").innerText = score;
            document.getElementById("life").innerText = life;
            document.getElementById("timer").innerText = timer;
            word.remove();
            activeWords.splice(i, 1);
            streak = 0;
            break;
          }
        }
        if (!matched) {
          timer = Math.max(0, timer - 5);
          updateStatus("âŒ ì˜¤ë‹µ! ì‹œê°„ -5ì´ˆ");
        }
        this.value = "";
      }
    });

    window.onload = startGame;
  </script>
</body>
</html>
