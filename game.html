<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê²½ë¶ì „ë¬¸ëŒ€í•™êµ 25í•™ë…„ë„ ë„ìŠ¤í´ë¡œë²„ ì‚¬ì´íŠ¸ì…ë‹ˆë‹¤.</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      max-width: 800px;
      margin: 20px auto;
      gap: 10px;
    }
    .card {
      background: #f0f0f0;
      padding: 20px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 14px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: background 0.3s;
      user-select: none;
    }
    .card.revealed { background: #d1eaff; }
    .card.matched { background: #b0f0b0; cursor: default; }
  </style>
</head>
<body>
  <h1>ğŸ“˜ ì˜ì–´-í•œê¸€ ì§ë§ì¶”ê¸° ê²Œì„</h1>
  <p>â±ï¸ <span id="timer">0</span>ì´ˆ | ì ìˆ˜: <span id="score">0</span></p>
  <label for="chapterSelect">ì±•í„° ì„ íƒ:</label>
  <select id="chapterSelect"><option value="ì§„ë£Œë¶€ì„œ">ì§„ë£Œë¶€ì„œ</option><option value="ê°„í˜¸ê¸°ë¡">ê°„í˜¸ê¸°ë¡</option><option value="ê¸°ë³¸ìš©ì–´">ê¸°ë³¸ìš©ì–´</option></select>
  <button onclick="startGame()">ê²Œì„ ì‹œì‘</button>
  <div id="game" class="grid"></div>
  <p id="status" style="color: green; font-weight: bold;"></p>

<script>
const allData = {"ì§„ë£Œë¶€ì„œ": [["OPD (outpatient department)", "ì™¸ë˜"], ["IPD (inpatient department)", "ì…ì›"], ["MED / IM (internal medicine)", "ë‚´ê³¼"]], "ê°„í˜¸ê¸°ë¡": [["before / ante", "ì´ì „"], ["after / post", "ì´í›„"], ["blood pressure", "í˜ˆì••"]], "ê¸°ë³¸ìš©ì–´": [["patient", "í™˜ì"], ["hospital", "ë³‘ì›"], ["treatment", "ì¹˜ë£Œ"]]};
let cards = [], firstCard = null, secondCard = null;
let matchedCount = 0, canClick = false, score = 0, timer = 0, timerInterval = null;

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function resetGameUI() {
  document.getElementById("score").innerText = "0";
  document.getElementById("timer").innerText = "0";
  document.getElementById("status").innerText = "";
  const gameBoard = document.getElementById("game");
  if (gameBoard) gameBoard.innerHTML = "";
}

function startGame() {
  clearInterval(timerInterval);
  resetGameUI();
  const chapter = document.getElementById("chapterSelect").value;
  const pairs = allData[chapter];
  if (!pairs || pairs.length < 1) {
    document.getElementById("status").innerText = "â— ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.";
    return;
  }
  matchedCount = 0; score = 0; timer = 0;
  firstCard = null; secondCard = null; canClick = false;

  cards = [];
  pairs.forEach(([eng, kor]) => {
    cards.push({ type: "ENG", value: eng, matched: false });
    cards.push({ type: "KOR", value: kor, matched: false });
  });
  shuffle(cards);

  const gameBoard = document.getElementById("game");
  cards.forEach((card, index) => {
    const div = document.createElement("div");
    div.classList.add("card", "revealed");
    div.dataset.index = index;
    div.innerText = card.value;
    div.onclick = () => flipCard(index);
    gameBoard.appendChild(div);
  });

  setTimeout(() => {
    document.querySelectorAll(".card").forEach(cardEl => {
      if (!cardEl.classList.contains("matched")) {
        cardEl.classList.remove("revealed");
        cardEl.innerText = "?";
      }
    });
    canClick = true;
  }, 2000);

  timerInterval = setInterval(() => {
    timer++;
    document.getElementById("timer").innerText = timer;
  }, 1000);
}

function flipCard(index) {
  if (!canClick) return;
  const cardEl = document.querySelectorAll(".card")[index];
  const card = cards[index];
  if (!card || card.matched || cardEl.classList.contains("revealed")) return;

  cardEl.classList.add("revealed");
  cardEl.innerText = card.value;

  if (!firstCard) {
    firstCard = { index, card };
  } else {
    secondCard = { index, card };
    canClick = false;

    if (isMatch(firstCard.card, secondCard.card)) {
      setTimeout(() => {
        cardEl.classList.add("matched");
        document.querySelectorAll(".card")[firstCard.index].classList.add("matched");
        cards[firstCard.index].matched = true;
        cards[secondCard.index].matched = true;
        matchedCount++; score += 10;
        document.getElementById("score").innerText = score;

        if (matchedCount === cards.length / 2) {
          clearInterval(timerInterval);
          document.getElementById("status").innerText = `ğŸ‰ ì„±ê³µ! ì ìˆ˜: ${score}, ì‹œê°„: ${timer}ì´ˆ`;
        }
        resetFlip();
      }, 400);
    } else {
      setTimeout(() => {
        cardEl.classList.remove("revealed");
        cardEl.innerText = "?";
        const firstEl = document.querySelectorAll(".card")[firstCard.index];
        firstEl.classList.remove("revealed");
        firstEl.innerText = "?";
        resetFlip();
      }, 800);
    }
  }
}

function resetFlip() {
  firstCard = null;
  secondCard = null;
  canClick = true;
}

function isMatch(card1, card2) {
  const chapter = document.getElementById("chapterSelect").value;
  const pairs = allData[chapter] || [];
  return pairs.some(([eng, kor]) =>
    (card1.type === "ENG" && card2.type === "KOR" && card1.value === eng && card2.value === kor) ||
    (card2.type === "ENG" && card1.type === "KOR" && card2.value === eng && card1.value === kor)
  );
}
</script>
</body>
</html>
